diff --git a/.idea/vcs.xml b/.idea/vcs.xml
index 54d6dce..d5353f9 100644
--- a/.idea/vcs.xml
+++ b/.idea/vcs.xml
@@ -4,6 +4,6 @@
     <mapping directory="" vcs="Git" />
     <mapping directory="$PROJECT_DIR$" vcs="Git" />
     <mapping directory="$PROJECT_DIR$/RLOR" vcs="Git" />
-    <mapping directory="$PROJECT_DIR$/rlor_vrp_experiments" vcs="Git" />
+    <mapping directory="$PROJECT_DIR$/rlor_vrp_gitlab" vcs="Git" />
   </component>
 </project>
\ No newline at end of file
diff --git a/.idea/workspace.xml b/.idea/workspace.xml
index 4a41165..f80e66b 100644
--- a/.idea/workspace.xml
+++ b/.idea/workspace.xml
@@ -4,238 +4,15 @@
     <option name="autoReloadType" value="SELECTIVE" />
   </component>
   <component name="ChangeListManager">
-    <list default="true" id="ba02fceb-bbae-4e4f-be3a-d63ede9d4b8e" name="Changes" comment="commit for gitlab">
-      <change afterPath="$PROJECT_DIR$/plot_rlor.py" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/runs/cvrp-v1__exp17_colabT4_50_steps___1__1711303112/DESCRIPTION" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/runs/cvrp-v1__exp5_50_steps___1__1711111788/events.out.tfevents.1711111813.VF-070237N.20088.0" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/runs/cvrp-v1__exp5_50_steps___1__1711111788/main.py" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/runs/cvrp-v1__exp5_50_steps___1__1711112094/events.out.tfevents.1711112114.VF-070237N.18068.0" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/runs/cvrp-v1__exp5_50_steps___1__1711112094/main.py" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/runs/cvrp-v1__exp5_50_steps___1__1711112859/events.out.tfevents.1711112903.VF-070237N.18980.0" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/runs/cvrp-v1__exp5_50_steps___1__1711112859/main.py" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/wandb/debug-cli.dein_el.log" afterDir="false" />
+    <list default="true" id="ba02fceb-bbae-4e4f-be3a-d63ede9d4b8e" name="Changes" comment="trained model in Colab. But faced a bug, the vehicle returns to depot after 1 customer. Need to adjust reward and mb context">
       <change beforePath="$PROJECT_DIR$/.idea/vcs.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/vcs.xml" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/RLOR" beforeDir="false" afterPath="$PROJECT_DIR$/RLOR" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/RLOR/envs/cvrp_vehfleet_env.py" beforeDir="false" afterPath="$PROJECT_DIR$/RLOR/envs/cvrp_vehfleet_env.py" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/ppo_or.py" beforeDir="false" afterPath="$PROJECT_DIR$/RLOR/ppo_or.py" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1709142957/events.out.tfevents.1709142957.VF-070237N.26348.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1709142957/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1709158109/events.out.tfevents.1709158109.VF-070237N.16304.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1709158109/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1709158266/events.out.tfevents.1709158266.VF-070237N.25872.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1709158266/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1709158482/events.out.tfevents.1709158482.VF-070237N.27352.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1709158482/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1709195544/events.out.tfevents.1709195544.VF-070237N.30664.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1709195544/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1709205861/events.out.tfevents.1709205861.VF-070237N.7812.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1709205861/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1709206128/events.out.tfevents.1709206128.VF-070237N.14788.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1709206128/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1710173364/events.out.tfevents.1710173364.VF-070237N.4224.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1710173364/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1710175045/events.out.tfevents.1710175045.VF-070237N.12348.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1710175045/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1710175526/events.out.tfevents.1710175526.VF-070237N.22764.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1710175526/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1710177137/events.out.tfevents.1710177137.VF-070237N.23140.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1710177137/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1710177195/events.out.tfevents.1710177195.VF-070237N.10176.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1710177195/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1710179161/events.out.tfevents.1710179161.VF-070237N.21540.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v0__ppo_or__1__1710179161/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709469312/events.out.tfevents.1709469312.VF-070237N.27568.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709469312/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709469436/events.out.tfevents.1709469436.VF-070237N.22592.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709469436/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709469651/events.out.tfevents.1709469651.VF-070237N.32696.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709469651/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709469742/events.out.tfevents.1709469742.VF-070237N.23688.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709469742/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709470086/events.out.tfevents.1709470086.VF-070237N.25308.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709470086/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709470272/events.out.tfevents.1709470272.VF-070237N.5248.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709470272/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709470577/events.out.tfevents.1709470577.VF-070237N.26696.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709470577/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709470741/events.out.tfevents.1709470741.VF-070237N.28040.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709470741/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709470913/events.out.tfevents.1709470913.VF-070237N.30792.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709470913/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709541926/events.out.tfevents.1709541926.VF-070237N.18716.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709541926/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709542302/events.out.tfevents.1709542302.VF-070237N.14952.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709542302/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709542686/events.out.tfevents.1709542686.VF-070237N.19464.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709542686/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709542929/events.out.tfevents.1709542929.VF-070237N.3324.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709542929/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709544219/events.out.tfevents.1709544219.VF-070237N.21800.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709544219/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709545700/events.out.tfevents.1709545700.VF-070237N.25784.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709545700/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709547013/events.out.tfevents.1709547013.VF-070237N.21888.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709547013/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709547168/events.out.tfevents.1709547168.VF-070237N.17456.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709547168/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709547448/events.out.tfevents.1709547448.VF-070237N.28712.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709547448/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709547900/events.out.tfevents.1709547900.VF-070237N.35260.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709547900/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709548574/events.out.tfevents.1709548574.VF-070237N.34552.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709548574/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709548942/events.out.tfevents.1709548942.VF-070237N.21836.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709548942/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709549383/events.out.tfevents.1709549383.VF-070237N.34120.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709549383/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709549793/events.out.tfevents.1709549793.VF-070237N.17228.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709549793/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709550142/events.out.tfevents.1709550142.VF-070237N.34916.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709550142/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709550290/events.out.tfevents.1709550290.VF-070237N.11828.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709550290/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709550555/events.out.tfevents.1709550555.VF-070237N.10260.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709550555/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709550636/events.out.tfevents.1709550636.VF-070237N.31512.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709550636/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709552211/events.out.tfevents.1709552211.VF-070237N.29608.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709552211/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709552382/events.out.tfevents.1709552382.VF-070237N.32876.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709552382/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709552490/events.out.tfevents.1709552490.VF-070237N.16460.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709552490/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709553140/events.out.tfevents.1709553140.VF-070237N.11420.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709553140/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709553265/events.out.tfevents.1709553265.VF-070237N.22016.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709553265/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709553582/events.out.tfevents.1709553582.VF-070237N.27708.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709553582/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709557141/events.out.tfevents.1709557141.VF-070237N.25056.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709557141/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709557918/events.out.tfevents.1709557918.VF-070237N.26944.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709557918/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709558025/events.out.tfevents.1709558025.VF-070237N.17832.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709558025/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709558596/events.out.tfevents.1709558596.VF-070237N.18584.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1709558596/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710170496/events.out.tfevents.1710170496.VF-070237N.19972.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710170496/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710191189/events.out.tfevents.1710191189.VF-070237N.13056.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710191189/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710260789/events.out.tfevents.1710260789.VF-070237N.2600.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710260789/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710261151/events.out.tfevents.1710261151.VF-070237N.25816.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710261151/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710261819/events.out.tfevents.1710261819.VF-070237N.6848.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710261819/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710270029/events.out.tfevents.1710270029.VF-070237N.21088.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710270029/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710271086/events.out.tfevents.1710271086.VF-070237N.21684.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710271086/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710271262/events.out.tfevents.1710271262.VF-070237N.21900.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710271262/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710272065/events.out.tfevents.1710272065.VF-070237N.25012.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710272065/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710272847/events.out.tfevents.1710272847.VF-070237N.22700.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710272847/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710273230/events.out.tfevents.1710273230.VF-070237N.27200.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710273230/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710273858/events.out.tfevents.1710273858.VF-070237N.23440.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710273858/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710274406/events.out.tfevents.1710274406.VF-070237N.12232.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710274406/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710274422/events.out.tfevents.1710274422.VF-070237N.22512.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710274422/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710275228/events.out.tfevents.1710275228.VF-070237N.3192.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710275228/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710275816/events.out.tfevents.1710275816.VF-070237N.26460.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710275816/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710275975/events.out.tfevents.1710275975.VF-070237N.22136.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710275975/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710276226/events.out.tfevents.1710276226.VF-070237N.26196.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710276226/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710277507/events.out.tfevents.1710277507.VF-070237N.23264.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710277507/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710277901/events.out.tfevents.1710277901.VF-070237N.20776.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710277901/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710321691/events.out.tfevents.1710321691.VF-070237N.15504.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710321691/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710323301/events.out.tfevents.1710323301.VF-070237N.3440.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710323301/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710327174/events.out.tfevents.1710327174.VF-070237N.16848.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710327174/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710328642/events.out.tfevents.1710328642.VF-070237N.16192.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710328642/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710328741/events.out.tfevents.1710328741.VF-070237N.16188.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710328741/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710329160/events.out.tfevents.1710329160.VF-070237N.8100.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710329160/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710329802/events.out.tfevents.1710329802.VF-070237N.3924.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710329802/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710331580/events.out.tfevents.1710331580.VF-070237N.17236.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710331580/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710332373/events.out.tfevents.1710332373.VF-070237N.11820.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710332373/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710332704/events.out.tfevents.1710332704.VF-070237N.17612.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710332704/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710332757/events.out.tfevents.1710332757.VF-070237N.18276.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710332757/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710332895/events.out.tfevents.1710332895.VF-070237N.16460.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710332895/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710333424/events.out.tfevents.1710333424.VF-070237N.17052.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710333424/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710333761/events.out.tfevents.1710333761.VF-070237N.18272.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710333761/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710333931/events.out.tfevents.1710333931.VF-070237N.18336.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710333931/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710333996/events.out.tfevents.1710333996.VF-070237N.14416.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710333996/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710334152/events.out.tfevents.1710334152.VF-070237N.5920.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710334152/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710334221/events.out.tfevents.1710334221.VF-070237N.11048.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710334221/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710335325/events.out.tfevents.1710335325.VF-070237N.3760.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710335325/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710335793/events.out.tfevents.1710335793.VF-070237N.13892.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710335793/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710338859/events.out.tfevents.1710338859.VF-070237N.18108.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710338859/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710340551/events.out.tfevents.1710340551.VF-070237N.7260.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710340551/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710342556/events.out.tfevents.1710342556.VF-070237N.17928.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710342556/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710409176/events.out.tfevents.1710409176.VF-070237N.14872.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710409176/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710428847/events.out.tfevents.1710428847.VF-070237N.12572.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710428847/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710429062/events.out.tfevents.1710429062.VF-070237N.19792.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710429062/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710432982/events.out.tfevents.1710432982.VF-070237N.19680.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710432982/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710433072/events.out.tfevents.1710433072.VF-070237N.16668.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710433072/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710433462/events.out.tfevents.1710433462.VF-070237N.8388.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710433462/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710434559/events.out.tfevents.1710434559.VF-070237N.14472.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710434559/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710434688/events.out.tfevents.1710434688.VF-070237N.15076.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710434688/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710434756/events.out.tfevents.1710434756.VF-070237N.21492.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710434756/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710435293/events.out.tfevents.1710435293.VF-070237N.15888.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710435293/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710435644/events.out.tfevents.1710435644.VF-070237N.19736.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710435644/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710435695/events.out.tfevents.1710435695.VF-070237N.18544.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710435695/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710436362/events.out.tfevents.1710436362.VF-070237N.17292.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710436362/main.py" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710436403/events.out.tfevents.1710436403.VF-070237N.17496.0" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/RLOR/runs/cvrp-v1__ppo_or__1__1710436403/main.py" beforeDir="false" />
+      <change beforePath="$PROJECT_DIR$/RLOR/envs/test_env.py" beforeDir="false" afterPath="$PROJECT_DIR$/RLOR/envs/test_env.py" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/RLOR/models/nets/attention_model/context.py" beforeDir="false" afterPath="$PROJECT_DIR$/RLOR/models/nets/attention_model/context.py" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/description.md" beforeDir="false" afterPath="$PROJECT_DIR$/description.md" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/rlor_vrp" beforeDir="false" afterPath="$PROJECT_DIR$/rlor_vrp" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/train_rlor_model.py" beforeDir="false" afterPath="$PROJECT_DIR$/model_inference.py" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/rlor_vrp" beforeDir="false" />
     </list>
     <option name="SHOW_DIALOG" value="false" />
     <option name="HIGHLIGHT_CONFLICTS" value="true" />
@@ -404,9 +181,31 @@
       <option name="INPUT_FILE" value="" />
       <method v="2" />
     </configuration>
+    <configuration name="test_env" type="PythonConfigurationType" factoryName="Python" temporary="true" nameIsGenerated="true">
+      <module name="rlor_vrp" />
+      <option name="INTERPRETER_OPTIONS" value="" />
+      <option name="PARENT_ENVS" value="true" />
+      <envs>
+        <env name="PYTHONUNBUFFERED" value="1" />
+      </envs>
+      <option name="SDK_HOME" value="" />
+      <option name="WORKING_DIRECTORY" value="$PROJECT_DIR$/RLOR/envs" />
+      <option name="IS_MODULE_SDK" value="true" />
+      <option name="ADD_CONTENT_ROOTS" value="true" />
+      <option name="ADD_SOURCE_ROOTS" value="true" />
+      <option name="SCRIPT_NAME" value="$PROJECT_DIR$/RLOR/envs/test_env.py" />
+      <option name="PARAMETERS" value="" />
+      <option name="SHOW_COMMAND_LINE" value="false" />
+      <option name="EMULATE_TERMINAL" value="false" />
+      <option name="MODULE_MODE" value="false" />
+      <option name="REDIRECT_INPUT" value="false" />
+      <option name="INPUT_FILE" value="" />
+      <method v="2" />
+    </configuration>
     <recent_temporary>
       <list>
         <item itemvalue="Python.plot_env" />
+        <item itemvalue="Python.test_env" />
         <item itemvalue="Python.model_inference" />
         <item itemvalue="Python.ppo_or" />
         <item itemvalue="Python.heuristic_solver" />
@@ -443,7 +242,14 @@
       <option name="project" value="LOCAL" />
       <updated>1710506842857</updated>
     </task>
-    <option name="localTasksCounter" value="4" />
+    <task id="LOCAL-00004" summary="trained model in Colab. But faced a bug, the vehicle returns to depot after 1 customer. Need to adjust reward and mb context">
+      <created>1711447491963</created>
+      <option name="number" value="00004" />
+      <option name="presentableId" value="LOCAL-00004" />
+      <option name="project" value="LOCAL" />
+      <updated>1711447491963</updated>
+    </task>
+    <option name="localTasksCounter" value="5" />
     <servers />
   </component>
   <component name="Vcs.Log.Tabs.Properties">
@@ -477,7 +283,8 @@
     </ignored-roots>
     <MESSAGE value="Here I started to implement the vehicle fleet environment. Changed the context in RLOR, added the additional environment. The biggest issue is to implement def go_to() because it process the trajectories for ppo." />
     <MESSAGE value="commit for gitlab" />
-    <option name="LAST_COMMIT_MESSAGE" value="commit for gitlab" />
+    <MESSAGE value="trained model in Colab. But faced a bug, the vehicle returns to depot after 1 customer. Need to adjust reward and mb context" />
+    <option name="LAST_COMMIT_MESSAGE" value="trained model in Colab. But faced a bug, the vehicle returns to depot after 1 customer. Need to adjust reward and mb context" />
   </component>
   <component name="XDebuggerManager">
     <breakpoint-manager>
@@ -557,16 +364,6 @@
           <line>80</line>
           <option name="timeStamp" value="77" />
         </line-breakpoint>
-        <line-breakpoint enabled="true" suspend="THREAD" type="python-line">
-          <url>file://$PROJECT_DIR$/RLOR/envs/cvrp_vehfleet_env.py</url>
-          <line>82</line>
-          <option name="timeStamp" value="89" />
-        </line-breakpoint>
-        <line-breakpoint enabled="true" suspend="THREAD" type="python-line">
-          <url>file://$PROJECT_DIR$/RLOR/envs/cvrp_vehfleet_env.py</url>
-          <line>86</line>
-          <option name="timeStamp" value="101" />
-        </line-breakpoint>
         <line-breakpoint enabled="true" suspend="THREAD" type="python-line">
           <url>file://$PROJECT_DIR$/model_inference.py</url>
           <line>12</line>
@@ -588,9 +385,26 @@
           <option name="timeStamp" value="105" />
         </line-breakpoint>
         <line-breakpoint enabled="true" suspend="THREAD" type="python-line">
+          <url>file://$PROJECT_DIR$/RLOR/envs/test_env.py</url>
+          <line>91</line>
+          <option name="timeStamp" value="118" />
+        </line-breakpoint>
+        <line-breakpoint enabled="true" suspend="THREAD" type="python-line">
+          <url>file://$PROJECT_DIR$/RLOR/envs/test_env.py</url>
+          <line>76</line>
+          <option name="timeStamp" value="124" />
+        </line-breakpoint>
+        <line-breakpoint enabled="true" suspend="THREAD" type="python-line">
+          <condition expression="self.load == 0" language="Python" />
+          <url>file://$PROJECT_DIR$/RLOR/envs/cvrp_vehfleet_env.py</url>
+          <line>132</line>
+          <option name="timeStamp" value="131" />
+        </line-breakpoint>
+        <line-breakpoint enabled="true" suspend="THREAD" type="python-line">
+          <condition expression="self.num_steps == 41" language="Python" />
           <url>file://$PROJECT_DIR$/RLOR/envs/cvrp_vehfleet_env.py</url>
-          <line>220</line>
-          <option name="timeStamp" value="106" />
+          <line>64</line>
+          <option name="timeStamp" value="135" />
         </line-breakpoint>
       </breakpoints>
       <default-breakpoints>
Submodule RLOR contains modified content
diff --git a/RLOR/envs/__pycache__/cvrp_vector_env.cpython-310.pyc b/RLOR/envs/__pycache__/cvrp_vector_env.cpython-310.pyc
new file mode 100644
index 0000000..10eb623
Binary files /dev/null and b/RLOR/envs/__pycache__/cvrp_vector_env.cpython-310.pyc differ
diff --git a/RLOR/envs/__pycache__/cvrp_vehfleet_env.cpython-310.pyc b/RLOR/envs/__pycache__/cvrp_vehfleet_env.cpython-310.pyc
new file mode 100644
index 0000000..9916997
Binary files /dev/null and b/RLOR/envs/__pycache__/cvrp_vehfleet_env.cpython-310.pyc differ
diff --git a/RLOR/envs/__pycache__/vrp_data.cpython-310.pyc b/RLOR/envs/__pycache__/vrp_data.cpython-310.pyc
new file mode 100644
index 0000000..503f5b2
Binary files /dev/null and b/RLOR/envs/__pycache__/vrp_data.cpython-310.pyc differ
diff --git a/RLOR/envs/cvrp_vehfleet_env.py b/RLOR/envs/cvrp_vehfleet_env.py
index 87779a8..2803866 100644
--- a/RLOR/envs/cvrp_vehfleet_env.py
+++ b/RLOR/envs/cvrp_vehfleet_env.py
@@ -28,6 +28,7 @@ class CVRPFleetEnv(gym.Env):
         self.eval_partition = "test"
         self.eval_data_idx = 0
         self.demand_limit = 10
+        self.penalty = 10
         assign_env_config(self, kwargs)
 
         obs_dict = {"observations": spaces.Box(low=0, high=1, shape=(self.max_nodes, 2))}
@@ -40,6 +41,7 @@ class CVRPFleetEnv(gym.Env):
         obs_dict["current_load"] = spaces.Box(low=0, high=1, shape=(self.n_traj,))
         obs_dict["num_veh"] =  spaces.MultiDiscrete([self.max_num_vehicles] * self.n_traj)
 
+
         self.observation_space = spaces.Dict(obs_dict)
         self.action_space = spaces.MultiDiscrete([self.max_nodes + 1] * self.n_traj)
         self.reward_space = None
@@ -68,7 +70,7 @@ class CVRPFleetEnv(gym.Env):
         traj_with_all_visited_or_no_vehicles = np.logical_or(is_all_visited, no_vehicles_left)
         #action = np.where(traj_with_all_visited_or_no_vehicles, 0, action)
         # need to revisit the first node after visited all other nodes
-        self.done = traj_with_all_visited_or_no_vehicles
+        self.done = is_all_visited #traj_with_all_visited_or_no_vehicles
 
         #self.done = (action == 0) & self.is_all_visited()
 
@@ -90,8 +92,16 @@ class CVRPFleetEnv(gym.Env):
 
     def no_other_vehicles(self):
         # Find indices where the number of vehicles is 0
-        indices_no_vehicles = np.where(self.num_veh == 0)[0]
-        self.visited[indices_no_vehicles, :] = True
+        # AND load is 1, meaning, that the load wass reseted in go_to, because the destination was zero there.
+        # This step occurs befor load is updated in def _update_state(self): -> def _update_mask(self)
+        condition = (self.num_veh == 0) #& (self.load == 1)
+        indices_no_vehicles = np.where(condition)[0]
+        self.visited[indices_no_vehicles, 1:] = True
+
+    def reward_func(self):
+
+        #the idea is to use vehicle load as penalty. when 1 (nothing was delivered, it is bad. and when 0, its good, so it is linear dependency!
+        return self.penalty * self.load
 
 
     def _update_state(self):
@@ -115,16 +125,19 @@ class CVRPFleetEnv(gym.Env):
 
         # can only visit depot when last node is not depot
         action_mask[:, 0] |= self.last != 0
-        #or all visited
+
+        # or all visited
         action_mask[:, 0] |= self.is_all_visited()
 
-        #mask all nodes, when number of vehicles is 0
+        # Not allow to visit nodes when the load is zero
+        action_mask[self.load <= 0, 1:] = False
 
         # not allow visit nodes with higher demand than capacity
         action_mask[:, 1:] &= self.demands <= (
             self.load.reshape(-1, 1) + 1e-5
         )  # to handle the floating point subtraction precision
 
+
         return action_mask
 
     def _RESET(self):
@@ -143,6 +156,9 @@ class CVRPFleetEnv(gym.Env):
         self.state = self._update_state()
         self.info = {}
         self.done = np.array([False] * self.n_traj)
+        #optional for plotting
+        self.distance = np.zeros(self.n_traj, dtype=float)
+
         return self.state
 
     def _load_orders(self):
@@ -160,6 +176,7 @@ class CVRPFleetEnv(gym.Env):
         self.demands_with_depot = self.demands.copy()
 
     def _go_to(self, destination):
+
         #print(f'destinations {destination}')
         # if capacity is below the demand, return to depot, restart veh capacity and reduce the number of veh
 
@@ -176,14 +193,15 @@ class CVRPFleetEnv(gym.Env):
         # Indices for operations
         destination_zero_condition = destination == 0
         true_indices_ = np.where(demand_exceed_capacity )[0]   # Indices where condition is true
-        false_indices_ = np.where(~demand_exceed_capacity)[0]  # Indices where condition is false
-
         destination_zero_ = np.where(destination == 0)[0]
-        destination_not_zero_ = np.where(destination != 0)[0]
 
         # trajectories here demand exceed capacity or destination is 0
         true_indices = np.unique(np.concatenate((true_indices_, destination_zero_)))
 
+        #check, if the num_veh is not already zero, and if so, delete the index from here.
+        # because I don't want to reduce vehicles or give the penalty, when the number of vehicles already zero
+        true_indices = true_indices[self.num_veh[true_indices] != 0]
+
         #if no depot destination and no exceeding capacity. just revert the indices of true array.
         false_indices = np.setdiff1d(np.arange(len(destination)),true_indices)
 
@@ -192,8 +210,8 @@ class CVRPFleetEnv(gym.Env):
         if len(true_indices)>0:
             dest_not_reached = destination[true_indices] #all not reached actions
 
-            return_to_depot_idx = self.last[true_indices] > 0  # if the last node was also a depot here
-            self.num_veh[true_indices[return_to_depot_idx]] -= 1 #if we are already here, decrease the num of vehicles
+            #return_to_depot_idx = self.last[true_indices] > 0  # if the last node was not a depot here
+            self.num_veh[true_indices] -= 1 #if we are already here, decrease the num of vehicles
 
             # only when  demand exceed capacity, we assign previous node, don't we?
             last_node = self.nodes[self.last[true_indices]] #get all previous nodes in the same trajectories
@@ -201,8 +219,6 @@ class CVRPFleetEnv(gym.Env):
             depot_node = self.nodes[dest_depot] #depot are the same in each batch instance.
             dist = self.cost(depot_node, last_node)
 
-
-
             #CHECK I commited this line, because if destination is 0, its already zero, the last action is zero
             #and if it exceed the capacity, then the last action should also be zero, right?
             self.last[true_indices] = dest_depot #assign last visited node. in this case this is allways 0, because we return. dest_not_reached
@@ -217,8 +233,9 @@ class CVRPFleetEnv(gym.Env):
             # meaning it choose 0 multiple times. In such a scenario, we should omit to assign fixcosts.
             # assign fixcosts only when it MUST return to  depot, meaning, when the demand exceed the capacity
 
-
-            reward[true_indices[return_to_depot_idx]] = -(dist[return_to_depot_idx] + 1) # 1 is a fix costs for vehicles. CHECK. To derive only the distance costs, we need to substract 5 from the total costs. right?
+            penalty_ = self.reward_func()
+            #+ penalty_[true_indices[return_to_depot_idx]]
+            reward[true_indices] = -(dist +  penalty_[true_indices]) # 1 is a fix costs for vehicles. CHECK. To derive only the distance costs, we need to substract 5 from the total costs. right?
 
             destination[true_indices] = 0
             #print(f'reward from env when return to depot {reward}')
@@ -230,24 +247,34 @@ class CVRPFleetEnv(gym.Env):
             dist = self.cost(dest_node, self.nodes[self.last[false_indices]])
 
             self.load[false_indices] -= self.demands[dest_next-1]
-
             self.demands_with_depot[dest_next-1] = 0
 
             #set destination to True, aka reached
             self.visited[false_indices, dest_next] = True
 
             # unmask the depot if the previous node is not a depo
-
             self.visited[false_indices, dest_depot] = False
 
             self.last[false_indices] = dest_next
-            reward[false_indices] = -dist
+            #penalty_[false_indices]
+            reward[false_indices] = -(dist)
 
-        self.load[destination == 0] = 1
+        #need this condition, because otherwise sometimes it assigns 1 to load when we have already used all vehicles
+        # ..this can cause some erroneuos behaviour, because we reset the load without changing the vehicle
+        condition = (destination == 0)
+        self.load[condition] = 1
         self.load[self.load<0] = 0
         self.num_veh[self.num_veh<=0] = 0
         self.reward = reward
+
+        #Delete for training
+        self.distance = dist
+
         #print(f'rewards from go_to {reward} \n ')
+        #print(f'self.load:  {self.load} \n ')
+
+
+
 
     def step(self, action):
         # return last state after done,
diff --git a/RLOR/envs/test_env.py b/RLOR/envs/test_env.py
index 75d3d04..00ff191 100644
--- a/RLOR/envs/test_env.py
+++ b/RLOR/envs/test_env.py
@@ -1,7 +1,62 @@
 import numpy as np
+from matplotlib import pyplot as plt
 
 from RLOR.envs.cvrp_vehfleet_env import CVRPFleetEnv
 
+class DataVisualizer:
+    def __init__(self, distance, rewards, num_veh, load):
+        self.distance = distance
+        self.rewards = rewards
+        self.num_veh = num_veh
+        self.load = load
+
+    def plot_line_chart(self):
+        # Extract the first item from each sublist for plotting
+        first_elements_distance = [sublist[0] for sublist in self.distance]
+        first_elements_rewards = [sublist[0] for sublist in self.rewards]
+        first_elements_num_veh = [sublist[0] for sublist in self.num_veh]
+        first_elements_load = [sublist[0] for sublist in self.load]
+
+        plt.figure(figsize=(10, 6))
+        plt.plot(first_elements_distance, label='Distance')
+        plt.plot(first_elements_rewards, label='Rewards')
+        plt.plot(first_elements_num_veh, label='Number of Vehicles')
+        plt.plot(first_elements_load, label='Load')
+        plt.title('Line Plot Comparisons')
+        plt.xlabel('Index')
+        plt.ylabel('Value')
+        plt.legend()
+        plt.xticks(np.arange(len(first_elements_distance)))
+        plt.grid(True)
+        plt.show()
+
+    def plot_scatter_charts(self):
+        # Extract the first item from each sublist for plotting
+        first_elements_load = [sublist[0] for sublist in self.load]
+        first_elements_rewards = [sublist[0] for sublist in self.rewards]
+        first_elements_distance = [sublist[0] for sublist in self.distance]
+
+        # Creating subplots for scatter plots
+        fig, axs = plt.subplots(1, 2, figsize=(14, 6))
+
+        # Scatter plot for Load vs Rewards
+        axs[0].scatter(first_elements_load, first_elements_rewards)
+        axs[0].set_title('Load vs Rewards')
+        axs[0].set_xlabel('Load')
+        axs[0].set_ylabel('Rewards')
+        axs[0].grid(True)
+
+        # Scatter plot for Distance vs Rewards
+        axs[1].scatter(first_elements_distance, first_elements_rewards)
+        axs[1].set_title('Distance vs Rewards')
+        axs[1].set_xlabel('Distance')
+        axs[1].set_ylabel('Rewards')
+        axs[1].grid(True)
+
+        plt.tight_layout()
+        plt.show()
+
+
 if __name__ == "__main__":
     env = CVRPFleetEnv()
     initi_state = env.reset()
@@ -10,17 +65,32 @@ if __name__ == "__main__":
     rewards = [] # (20,35)
     done = np.full(n_traj, False)
     nr_of_steps = 0
-    while not np.all(done):
+    loads = []
+    vehicles = []
+    distances = []
+    steps_per_vehicle = []
+    #distances.append(env.distance)
+    while not done[0]==True:
         action = env.action_space.sample()
         print(f'action {action}')
         state, reward, done, info =  env.step(action)
+
+        distances.append(env.distance)
         rewards.append(reward)
+        vehicles.append(state["num_veh"].copy())
+        loads.append(state["current_load"].copy())
         #print(f'state {state}; \n reward {reward}; \n done {done};')
         nr_of_steps +=1
         print("______________________________________________")
 
+    visualizer = DataVisualizer(distances, rewards, vehicles, loads)
+    visualizer.plot_line_chart()  # This will open the first plot window
+    visualizer.plot_scatter_charts()  # This will open
+
+
 
     sums = np.sum(rewards, axis = 0)
+
     print(f' size {sums.size} , sum the rewards {sums}')
 
     substract_fix_costs = sums + 5 #plus, becasue the distance is negative and I want to substract
@@ -36,4 +106,6 @@ if __name__ == "__main__":
 
     print(f' total average in all episodes with fixcosts {np.mean(avg_episodic_return)}')
 
-    print("difference is 0.400961 when number of stes is 20")
\ No newline at end of file
+    print("difference is 0.400961 when number of stes is 20")
+
+
diff --git a/RLOR/models/__pycache__/attention_model_wrapper.cpython-310.pyc b/RLOR/models/__pycache__/attention_model_wrapper.cpython-310.pyc
new file mode 100644
index 0000000..cdbd185
Binary files /dev/null and b/RLOR/models/__pycache__/attention_model_wrapper.cpython-310.pyc differ
diff --git a/RLOR/models/nets/__pycache__/__init__.cpython-310.pyc b/RLOR/models/nets/__pycache__/__init__.cpython-310.pyc
new file mode 100644
index 0000000..2cd2392
Binary files /dev/null and b/RLOR/models/nets/__pycache__/__init__.cpython-310.pyc differ
diff --git a/RLOR/models/nets/attention_model/__pycache__/__init__.cpython-310.pyc b/RLOR/models/nets/attention_model/__pycache__/__init__.cpython-310.pyc
new file mode 100644
index 0000000..723f98c
Binary files /dev/null and b/RLOR/models/nets/attention_model/__pycache__/__init__.cpython-310.pyc differ
diff --git a/RLOR/models/nets/attention_model/__pycache__/attention_model.cpython-310.pyc b/RLOR/models/nets/attention_model/__pycache__/attention_model.cpython-310.pyc
new file mode 100644
index 0000000..96112b6
Binary files /dev/null and b/RLOR/models/nets/attention_model/__pycache__/attention_model.cpython-310.pyc differ
diff --git a/RLOR/models/nets/attention_model/__pycache__/context.cpython-310.pyc b/RLOR/models/nets/attention_model/__pycache__/context.cpython-310.pyc
new file mode 100644
index 0000000..b3b52b6
Binary files /dev/null and b/RLOR/models/nets/attention_model/__pycache__/context.cpython-310.pyc differ
diff --git a/RLOR/models/nets/attention_model/__pycache__/decoder.cpython-310.pyc b/RLOR/models/nets/attention_model/__pycache__/decoder.cpython-310.pyc
new file mode 100644
index 0000000..e1f3905
Binary files /dev/null and b/RLOR/models/nets/attention_model/__pycache__/decoder.cpython-310.pyc differ
diff --git a/RLOR/models/nets/attention_model/__pycache__/dynamic_embedding.cpython-310.pyc b/RLOR/models/nets/attention_model/__pycache__/dynamic_embedding.cpython-310.pyc
new file mode 100644
index 0000000..f46d595
Binary files /dev/null and b/RLOR/models/nets/attention_model/__pycache__/dynamic_embedding.cpython-310.pyc differ
diff --git a/RLOR/models/nets/attention_model/__pycache__/embedding.cpython-310.pyc b/RLOR/models/nets/attention_model/__pycache__/embedding.cpython-310.pyc
new file mode 100644
index 0000000..e9798ac
Binary files /dev/null and b/RLOR/models/nets/attention_model/__pycache__/embedding.cpython-310.pyc differ
diff --git a/RLOR/models/nets/attention_model/__pycache__/encoder.cpython-310.pyc b/RLOR/models/nets/attention_model/__pycache__/encoder.cpython-310.pyc
new file mode 100644
index 0000000..fce3057
Binary files /dev/null and b/RLOR/models/nets/attention_model/__pycache__/encoder.cpython-310.pyc differ
diff --git a/RLOR/models/nets/attention_model/__pycache__/multi_head_attention.cpython-310.pyc b/RLOR/models/nets/attention_model/__pycache__/multi_head_attention.cpython-310.pyc
new file mode 100644
index 0000000..cb3f689
Binary files /dev/null and b/RLOR/models/nets/attention_model/__pycache__/multi_head_attention.cpython-310.pyc differ
diff --git a/RLOR/models/nets/attention_model/context.py b/RLOR/models/nets/attention_model/context.py
index 471f49e..e43919d 100644
--- a/RLOR/models/nets/attention_model/context.py
+++ b/RLOR/models/nets/attention_model/context.py
@@ -263,6 +263,7 @@ class CVRPFleetContext(PrevNodeContext):
     def _state_embedding(self, embeddings, state):
         state_embedding = -state.used_capacity[:, :, None]
         vehicles = state.get_num_veh()
+
         #depot_and_veh = torch.cat((input["depot"], input["num_veh"][:, None, None]), -1)
 
         #state_embedding = torch.cat((vehicles[:,None,None],state_embedding,), -2) # -> (1024, 51, 1) Concantenate 50 nodes AND num  of vehicles as Depot
diff --git a/RLOR/ppo_or.py b/RLOR/ppo_or.py
index cdd9e9e..571538b 100644
--- a/RLOR/ppo_or.py
+++ b/RLOR/ppo_or.py
@@ -362,7 +362,7 @@ if __name__ == "__main__":
         writer.add_scalar("losses/explained_variance", explained_var, global_step)
         print("SPS:", int(global_step / (time.time() - start_time)))
         writer.add_scalar("charts/SPS", int(global_step / (time.time() - start_time)), global_step)
-        if update % 100 == 0 or update == num_updates:
+        if update % 1 == 0 or update == num_updates:
             torch.save(agent.state_dict(), f"runs/{run_name}/ckpt/{update}.pt")
         if update % 100 == 0 or update == num_updates:
             agent.eval()
diff --git a/RLOR/wrappers/__pycache__/recordWrapper.cpython-310.pyc b/RLOR/wrappers/__pycache__/recordWrapper.cpython-310.pyc
new file mode 100644
index 0000000..c157444
Binary files /dev/null and b/RLOR/wrappers/__pycache__/recordWrapper.cpython-310.pyc differ
diff --git a/RLOR/wrappers/__pycache__/syncVectorEnvPomo.cpython-310.pyc b/RLOR/wrappers/__pycache__/syncVectorEnvPomo.cpython-310.pyc
new file mode 100644
index 0000000..4069948
Binary files /dev/null and b/RLOR/wrappers/__pycache__/syncVectorEnvPomo.cpython-310.pyc differ
diff --git a/description.md b/description.md
index 6e520f9..8ee7116 100644
--- a/description.md
+++ b/description.md
@@ -18,7 +18,7 @@ For comparison, when using the RLLib, I need only define my simple problem envir
 
 for RLLib documentation read also this https://openreview.net/pdf?id=trNDfee72NQ
 
-Lets take a look on the environment. There are many issues with that!
+Lets take a look at the environment. There are many issues with that!
 First, you need to understand the concept of batches (like many parallel environment) and trajectories (like simultaneous actions in one timestep in the same environment)
 First, we have to recall, that the PPO need trajectories, and they are somehow tricky to understand.
 For example
Submodule rlor_vrp e563ebc...0000000 (submodule deleted)
diff --git a/train_collab_notesLog.txt b/train_collab_notesLog.txt
index bf8803c..56499cc 100644
--- a/train_collab_notesLog.txt
+++ b/train_collab_notesLog.txt
@@ -1,7 +1,7 @@
 1 step -> 11.2 GPU RAM
 however, after the second sep, it still consumed 11.2 ram..so i seems to be stable here
 
-all experiments were crushed because of GPU RAM capacity.
+all experiments were crashed because of GPU RAM capacity.
 Started to train on A100 with 40gb gpu ram and 83gb system ram but for 13 RechenEinheit/h ->exp11
 
 idea: mb I slowdown training by printing out everythin...
